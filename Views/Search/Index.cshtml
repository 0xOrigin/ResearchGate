@using Research_Gate.Controllers
@model IEnumerable<Research_Gate.Models.Author>
@{
    ViewBag.Title = "Search";
}

<div class="search-container">
    <input type="text" placeholder="Write here....." name="SearchBox" id="SearchBox" class="search-textbox" />
    <select name="SearchBySelector" id="SearchBySelector" class="SearchBySelector">
        <option value="SearchByName" selected>Name</option>
        <option value="SearchByEmail">Email</option>
        <option value="SearchByUniversity">University</option>
    </select>
    <input type="button" name="Search" id="Submit" class="search-button" value="Search" />
    <div class="separator"></div>
    <div class="result-container">
    @foreach (var author in Model)
    {
        var path = @author.Img_path;
        <div class="result-box">
            <a class="profile-link-name" href="@Url.Action("Index", "Profile", new {id = author.Author_id})">
                <img src="@Url.Content(FileUtility.GetAuthorImage(author.Img_path))" class="author-image" id="imgs" />
            </a>
            <div>
                <a class="profile-link-name" href="@Url.Action("Index", "Profile", new { id = author.Author_id })">
                    <span class="values">@author.Fname @author.Lname</span>
                </a>
            </div>
            <div>
                <span class="labels">Institution</span>
                <span class="values">@author.University</span>
            </div>
            <div>
                <span class="labels">Department</span>
                <span class="values">@author.Department</span>
            </div>
            <div>
                <a class="profile-link-line" href="@Url.Action("Index", "Profile", new { id = author.Author_id })">
                    <span class="values">View profile</span>
                </a>
            </div>
        </div>
    }
    </div>
</div>

@section Scripts
{
    <script>
        $("#Submit").on('click', function () {

            var searchBoxValue = $("#SearchBox").val();
            searchBoxValue = (searchBoxValue == '' ? 0 : searchBoxValue);

            $.ajax({
                url: "/Search/" + $("#SearchBySelector").val()  + "/" + searchBoxValue,
                type: 'POST',
                async: true,
                cache: false,
                success: function (result) {
                    console.log(result);
                    var w = window.open('/Search/Index', '_self');
                },
                error: function (xhr) {
                    alert("An error occurred: " + xhr.status + " " + xhr.statusText);
                }
            });
        });

        $(window).on('load',function(){
            $.ajax({
                url: "/Search/ClearResults/",
                type: 'POST',
                async: true,
                cache: false,
                success: function (result) {
                    
                },
                error: function (xhr) {
                    alert("An error occurred: " + xhr.status + " " + xhr.statusText);
                }
            });
        });
        
    </script>
}
